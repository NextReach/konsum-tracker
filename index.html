<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tracker</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,sans-serif;background:#f9fafb}.container{max-width:600px;margin:0 auto;padding:1rem}.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}h1{font-size:1.5rem;font-weight:bold;color:#111}.btn{background:none;border:none;padding:.5rem;cursor:pointer;border-radius:.5rem}.btn:hover{background:#e5e7eb}.card{background:#fff;border-radius:.75rem;box-shadow:0 1px 3px rgba(0,0,0,.1);padding:1rem;margin-bottom:1rem}.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}.grid-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:.75rem}.add-btn{padding:1rem;border:none;border-radius:.75rem;font-weight:500;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:.5rem;color:#fff}.add-btn:active{transform:scale(.95)}.cig-btn{background:#f97316}.cig-btn:hover{background:#ea580c}.joint-btn{background:#10b981}.joint-btn:hover{background:#059669}.input-group{margin-bottom:.75rem}.input-group label{display:block;font-size:.875rem;color:#6b7280;margin-bottom:.25rem}.input-group input,.input-group select{width:100%;padding:.5rem .75rem;border:1px solid #d1d5db;border-radius:.5rem;font-size:1rem}h3{font-size:1rem;margin-bottom:.75rem;color:#111}.progress-bar{width:100%;height:.5rem;background:#e5e7eb;border-radius:9999px;overflow:hidden;margin-top:.25rem}.progress-fill{height:100%;transition:width .3s}.progress-cig{background:#f97316}.progress-joint{background:#10b981}.progress-over{background:#ef4444}.stats{text-align:center}.stat-value{font-size:1.5rem;font-weight:bold}.stat-label{font-size:.75rem;color:#6b7280;margin-top:.25rem}.view-tabs{display:flex;gap:.5rem;overflow-x:auto;margin-bottom:1rem}.tab{padding:.5rem 1rem;border:1px solid #e5e7eb;border-radius:.5rem;font-weight:500;cursor:pointer;white-space:nowrap;background:#fff;color:#374151}.tab.active{background:#111;color:#fff;border-color:#111}.tab:hover:not(.active){background:#f3f4f6}.chart{margin-top:1rem}.bar-group{display:flex;align-items:flex-end;gap:.25rem;flex:1;justify-content:center}.bar{width:12px;border-radius:.25rem .25rem 0 0;transition:height .3s}.bar-cig{background:#f97316}.bar-joint{background:#10b981}.chart-wrapper{display:flex;align-items:flex-end;gap:.5rem;height:150px;border:1px solid #e5e7eb;padding:.5rem;border-radius:.5rem}.chart-item{flex:1;display:flex;flex-direction:column;align-items:center;height:100%}.chart-label{font-size:.625rem;color:#6b7280;margin-top:.25rem}.progress-info{display:flex;justify-content:space-between;font-size:.875rem;margin-bottom:.25rem}.progress-text{color:#6b7280}.progress-value{font-weight:500}.entry-item{padding:.75rem;background:#f9fafb;border-radius:.5rem;margin-bottom:.5rem;display:flex;justify-content:space-between;align-items:center}.entry-info{display:flex;align-items:center;gap:.5rem}.entry-dot{width:.75rem;height:.75rem;border-radius:50%}.entry-dot-cig{background:#f97316}.entry-dot-joint{background:#10b981}.entry-text{font-size:.875rem}.entry-time{color:#6b7280;font-size:.75rem}.delete-btn{background:#fee2e2;color:#dc2626;border:none;padding:.25rem .75rem;border-radius:.375rem;font-size:.75rem;cursor:pointer}.delete-btn:hover{background:#fecaca}.page{display:none}.page.active{display:block}.nav-btn{flex:1;padding:.75rem;border:1px solid #e5e7eb;border-radius:.5rem;font-weight:500;cursor:pointer;background:#fff;color:#374151}.nav-btn.active{background:#111;color:#fff;border-color:#111}
</style>
</head>
<body>
<div class="container">
<div class="header">
<h1>Konsum Tracker</h1>
<button class="btn" onclick="toggleSettings()">‚öôÔ∏è</button>
</div>

<div class="grid-2" style="margin-bottom:1rem">
<button class="nav-btn active" onclick="switchPage('overview')">√úbersicht</button>
<button class="nav-btn" onclick="switchPage('compare')">Vergleich</button>
</div>

<div id="settingsCard" class="card" style="display:none">
<h3>Einstellungen</h3>
<div class="grid-2">
<div class="input-group">
<label>Preis/Zigarette (‚Ç¨)</label>
<input type="number" step="0.01" id="cigPrice" value="0.30" onchange="saveSettings()">
</div>
<div class="input-group">
<label>Preis/Joint (‚Ç¨)</label>
<input type="number" step="0.01" id="jointPrice" value="5.00" onchange="saveSettings()">
</div>
<div class="input-group">
<label>Wochenziel Zigaretten</label>
<input type="number" id="goalCigs" value="70" onchange="saveSettings()">
</div>
<div class="input-group">
<label>Wochenziel Joints</label>
<input type="number" id="goalJoints" value="7" onchange="saveSettings()">
</div>
</div>
</div>

<div id="overviewPage" class="page active">
<div class="grid-2">
<button class="add-btn cig-btn" onclick="addEntry('cigarette')">+ Zigarette</button>
<button class="add-btn joint-btn" onclick="addEntry('joint')">+ Joint</button>
</div>

<div class="card">
<h3>Wochenziel</h3>
<div style="margin-bottom:.75rem">
<div class="progress-info">
<span class="progress-text">Zigaretten</span>
<span class="progress-value" id="weekCigs">0 / 70</span>
</div>
<div class="progress-bar">
<div class="progress-fill progress-cig" id="weekCigsBar"></div>
</div>
</div>
<div>
<div class="progress-info">
<span class="progress-text">Joints</span>
<span class="progress-value" id="weekJoints">0 / 7</span>
</div>
<div class="progress-bar">
<div class="progress-fill progress-joint" id="weekJointsBar"></div>
</div>
</div>
</div>

<div class="view-tabs">
<button class="tab active" onclick="changeView('day')">Tag</button>
<button class="tab" onclick="changeView('week')">Woche</button>
<button class="tab" onclick="changeView('month')">Monat</button>
<button class="tab" onclick="changeView('year')">Jahr</button>
</div>

<div class="card">
<div class="grid-3" style="margin-bottom:1rem">
<div class="stats">
<div class="stat-value" style="color:#f97316" id="statCigs">0</div>
<div class="stat-label">Zigaretten</div>
</div>
<div class="stats">
<div class="stat-value" style="color:#10b981" id="statJoints">0</div>
<div class="stat-label">Joints</div>
</div>
<div class="stats">
<div class="stat-value" id="statCost">0.00‚Ç¨</div>
<div class="stat-label">Kosten</div>
</div>
</div>
<div id="chart" class="chart"></div>
</div>

<div class="card">
<h3>Letzte Eintr√§ge</h3>
<div id="entryList"></div>
</div>
</div>

<div id="comparePage" class="page">
<div class="card">
<h3>Wochen Vergleich</h3>
<div id="weekCompare"></div>
</div>
<div class="card">
<h3>Monate Vergleich</h3>
<div id="monthCompare"></div>
</div>
</div>
</div>

<script>
let entries=[];let settings={cigPrice:0.30,jointPrice:5.00,weeklyGoalCigs:70,weeklyGoalJoints:7};let currentView='day';let currentPage='overview';function loadData(){const s=localStorage.getItem('consumption-entries');const ss=localStorage.getItem('consumption-settings');if(s)entries=JSON.parse(s);if(ss){settings=JSON.parse(ss);document.getElementById('cigPrice').value=settings.cigPrice;document.getElementById('jointPrice').value=settings.jointPrice;document.getElementById('goalCigs').value=settings.weeklyGoalCigs;document.getElementById('goalJoints').value=settings.weeklyGoalJoints}updateUI()}function saveData(){localStorage.setItem('consumption-entries',JSON.stringify(entries));localStorage.setItem('consumption-settings',JSON.stringify(settings))}function saveSettings(){settings.cigPrice=parseFloat(document.getElementById('cigPrice').value)||0;settings.jointPrice=parseFloat(document.getElementById('jointPrice').value)||0;settings.weeklyGoalCigs=parseInt(document.getElementById('goalCigs').value)||0;settings.weeklyGoalJoints=parseInt(document.getElementById('goalJoints').value)||0;saveData();updateUI()}function toggleSettings(){const el=document.getElementById('settingsCard');el.style.display=el.style.display==='none'?'block':'none'}function switchPage(page){currentPage=page;document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));if(page==='overview'){document.getElementById('overviewPage').classList.add('active');event.target.classList.add('active')}else if(page==='compare'){document.getElementById('comparePage').classList.add('active');event.target.classList.add('active');updateCompare()}}function addEntry(type){const now=new Date();const st=now.toLocaleTimeString('de-DE',{hour:'2-digit',minute:'2-digit'}).replace(':','.');const et=new Date(now.getTime()+10*60000).toLocaleTimeString('de-DE',{hour:'2-digit',minute:'2-digit'}).replace(':','.');entries.unshift({id:Date.now(),type,timestamp:now.toISOString(),timeWindow:st+' - '+et});saveData();updateUI()}function changeView(view){currentView=view;document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));event.target.classList.add('active');updateUI()}function updateUI(){if(currentPage==='overview')updateOverview();else if(currentPage==='compare')updateCompare()}function updateOverview(){const now=new Date();const ws=new Date(now);ws.setDate(now.getDate()-now.getDay()+1);ws.setHours(0,0,0,0);const we=entries.filter(e=>new Date(e.timestamp)>=ws);const wc=we.filter(e=>e.type==='cigarette').length;const wj=we.filter(e=>e.type==='joint').length;const cp=Math.round((wc/settings.weeklyGoalCigs)*100);const jp=Math.round((wj/settings.weeklyGoalJoints)*100);document.getElementById('weekCigs').textContent=wc+' / '+settings.weeklyGoalCigs;document.getElementById('weekJoints').textContent=wj+' / '+settings.weeklyGoalJoints;const cb=document.getElementById('weekCigsBar');cb.style.width=Math.min(cp,100)+'%';cb.className='progress-fill '+(cp>100?'progress-over':'progress-cig');const jb=document.getElementById('weekJointsBar');jb.style.width=Math.min(jp,100)+'%';jb.className='progress-fill '+(jp>100?'progress-over':'progress-joint');const td=now.toISOString().split('T')[0];const te=entries.filter(e=>e.timestamp.split('T')[0]===td);const tc=te.filter(e=>e.type==='cigarette').length;const tj=te.filter(e=>e.type==='joint').length;const cost=tc*settings.cigPrice+tj*settings.jointPrice;document.getElementById('statCigs').textContent=tc;document.getElementById('statJoints').textContent=tj;document.getElementById('statCost').textContent=cost.toFixed(2)+'‚Ç¨';const periods=[];const cnt=currentView==='day'?7:currentView==='week'?6:currentView==='month'?6:5;if(currentView==='day'){for(let i=0;i<cnt;i++){const d=new Date(now);d.setDate(now.getDate()-(cnt-1-i));periods.push(d)}}else if(currentView==='week'){for(let i=2;i>=0;i--){const d=new Date(now);d.setDate(now.getDate()-i*7);periods.push(d)}for(let i=1;i<=3;i++){const d=new Date(now);d.setDate(now.getDate()+i*7);periods.push(d)}}else if(currentView==='month'){for(let i=0;i<6;i++){const d=new Date(2025,10+i,1);periods.push(d)}}else{for(let i=0;i<5;i++){const d=new Date(2025+i,0,1);periods.push(d)}}const cd=periods.map(date=>{let pe=[];if(currentView==='day'){const dk=date.toISOString().split('T')[0];pe=entries.filter(e=>e.timestamp.split('T')[0]===dk)}else if(currentView==='week'){const ws=new Date(date);ws.setHours(0,0,0,0);const we=new Date(ws);we.setDate(ws.getDate()+6);we.setHours(23,59,59,999);pe=entries.filter(e=>{const ed=new Date(e.timestamp);return ed>=ws&&ed<=we})}else if(currentView==='month'){pe=entries.filter(e=>{const ed=new Date(e.timestamp);return ed.getMonth()===date.getMonth()&&ed.getFullYear()===date.getFullYear()})}else if(currentView==='year'){pe=entries.filter(e=>{const ed=new Date(e.timestamp);return ed.getFullYear()===date.getFullYear()})}const c=pe.filter(e=>e.type==='cigarette').length;const j=pe.filter(e=>e.type==='joint').length;const d=new Date(date);let lbl;if(currentView==='day'){lbl=String(d.getDate()).padStart(2,'0')+'.'+String(d.getMonth()+1).padStart(2,'0')}else if(currentView==='week'){lbl=String(d.getDate()).padStart(2,'0')+'.'+String(d.getMonth()+1).padStart(2,'0')}else if(currentView==='month'){lbl=String(d.getMonth()+1).padStart(2,'0')+'/'+String(d.getFullYear()).slice(-2)}else{lbl=String(d.getFullYear())}return{cigs:c,joints:j,label:lbl}});let maxScale;if(currentView==='day'){maxScale=Math.max(settings.weeklyGoalCigs/7,settings.weeklyGoalJoints/7,10)}else if(currentView==='week'){maxScale=Math.max(settings.weeklyGoalCigs,settings.weeklyGoalJoints,50)}else if(currentView==='month'){maxScale=Math.max(settings.weeklyGoalCigs*4,settings.weeklyGoalJoints*4,200)}else{maxScale=Math.max(settings.weeklyGoalCigs*52,settings.weeklyGoalJoints*52,1000)}const actualMax=Math.max(...cd.map(d=>Math.max(d.cigs,d.joints)),1);const mv=Math.max(maxScale,actualMax);const ch='<div class="chart-wrapper">'+cd.map(d=>{const ch=d.cigs>0?(d.cigs/mv)*100:0;const jh=d.joints>0?(d.joints/mv)*100:0;return'<div class="chart-item"><div class="bar-group"><div class="bar bar-cig" style="height:'+ch+'%;min-height:'+(d.cigs>0?'4px':'0')+'" title="'+d.cigs+' Zigaretten"></div><div class="bar bar-joint" style="height:'+jh+'%;min-height:'+(d.joints>0?'4px':'0')+'" title="'+d.joints+' Joints"></div></div><div class="chart-label">'+d.label+'</div><div style="font-size:0.625rem;color:#6b7280;margin-top:0.125rem">'+d.cigs+'/'+d.joints+'</div></div>'}).join('')+'</div>';document.getElementById('chart').innerHTML=ch;const el=entries.slice(0,20).map(e=>{const dt=new Date(e.timestamp);const ds=dt.toLocaleDateString('de-DE');const tl=e.type==='cigarette'?'üö¨ Zigarette':'üåø Joint';const dc=e.type==='cigarette'?'entry-dot-cig':'entry-dot-joint';return'<div class="entry-item"><div class="entry-info"><div class="entry-dot '+dc+'"></div><div><div class="entry-text">'+tl+'</div><div class="entry-time">'+ds+', '+e.timeWindow+'</div></div></div><button class="delete-btn" onclick="deleteEntry('+e.id+')">L√∂schen</button></div>'}).join('');document.getElementById('entryList').innerHTML=el||'<div style="text-align:center;color:#9ca3af;padding:2rem">Noch keine Eintr√§ge</div>'}function updateCompare(){const now=new Date();const weeks=[];for(let i=0;i<4;i++){const ws=new Date(now);ws.setDate(now.getDate()-now.getDay()+1-(i*7));const we2=new Date(ws);we2.setDate(ws.getDate()+6);const wes=entries.filter(e=>{const d=new Date(e.timestamp);return d>=ws&&d<=we2});const c=wes.filter(e=>e.type==='cigarette').length;const j=wes.filter(e=>e.type==='joint').length;const co=c*settings.cigPrice+j*settings.jointPrice;weeks.push({label:'KW '+ws.toLocaleDateString('de-DE',{day:'2-digit',month:'2-digit'}),cigs:c,joints:j,cost:co})}const wh=weeks.map(w=>'<div style="padding:1rem;background:#f9fafb;border-radius:.5rem;margin-bottom:.75rem"><div style="font-weight:600;margin-bottom:.5rem">'+w.label+'</div><div style="display:flex;justify-content:space-around"><div style="text-align:center"><div style="font-size:1.25rem;font-weight:bold;color:#f97316">'+w.cigs+'</div><div style="font-size:.75rem;color:#6b7280">Zigaretten</div></div><div style="text-align:center"><div style="font-size:1.25rem;font-weight:bold;color:#10b981">'+w.joints+'</div><div style="font-size:.75rem;color:#6b7280">Joints</div></div><div style="text-align:center"><div style="font-size:1.25rem;font-weight:bold">'+w.cost.toFixed(2)+'‚Ç¨</div><div style="font-size:.75rem;color:#6b7280">Kosten</div></div></div></div>').join('');document.getElementById('weekCompare').innerHTML=wh;const months=[];for(let i=0;i<3;i++){const md=new Date(now);md.setMonth(now.getMonth()-i);const ms=new Date(md.getFullYear(),md.getMonth(),1);const me=new Date(md.getFullYear(),md.getMonth()+1,0);const mes=entries.filter(e=>{const d=new Date(e.timestamp);return d>=ms&&d<=me});const c=mes.filter(e=>e.type==='cigarette').length;const j=mes.filter(e=>e.type==='joint').length;const co=c*settings.cigPrice+j*settings.jointPrice;months.push({label:md.toLocaleDateString('de-DE',{month:'long',year:'numeric'}),cigs:c,joints:j,cost:co})}const mh=months.map(m=>'<div style="padding:1rem;background:#f9fafb;border-radius:.5rem;margin-bottom:.75rem"><div style="font-weight:600;margin-bottom:.5rem">'+m.label+'</div><div style="display:flex;justify-content:space-around"><div style="text-align:center"><div style="font-size:1.25rem;font-weight:bold;color:#f97316">'+m.cigs+'</div><div style="font-size:.75rem;color:#6b7280">Zigaretten</div></div><div style="text-align:center"><div style="font-size:1.25rem;font-weight:bold;color:#10b981">'+m.joints+'</div><div style="font-size:.75rem;color:#6b7280">Joints</div></div><div style="text-align:center"><div style="font-size:1.25rem;font-weight:bold">'+m.cost.toFixed(2)+'‚Ç¨</div><div style="font-size:.75rem;color:#6b7280">Kosten</div></div></div></div>').join('');document.getElementById('monthCompare').innerHTML=mh}function deleteEntry(id){entries=entries.filter(e=>e.id!==id);saveData();updateUI()}loadData();
</script>
</body>
</html>